<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çº¿ç¼†æŠ¥ä»·å•è¯†åˆ«ä¸å¯¼å‡º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "å¾®è½¯é›…é»‘", sans-serif;
        }
        body {
            padding: 50px;
            background: #f5f5f5;
        }
        .upload-box {
            width: 600px;
            height: 300px;
            border: 2px dashed #ccc;
            border-radius: 10px;
            margin: 0 auto 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        .upload-box.active {
            border-color: #409eff;
            background: #e8f4fc;
        }
        .upload-box input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .upload-text {
            text-align: center;
            color: #666;
        }
        .upload-text i {
            font-size: 48px;
            margin-bottom: 10px;
            display: block;
        }
        .progress {
            width: 600px;
            height: 20px;
            border-radius: 10px;
            background: #eee;
            margin: 0 auto 20px;
            overflow: hidden;
            display: none;
        }
        .progress-bar {
            height: 100%;
            background: #409eff;
            width: 0%;
            transition: width 0.3s;
        }
        .preview {
            width: 600px;
            margin: 0 auto 20px;
            display: none;
        }
        .preview img {
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .download-btn {
            display: block;
            width: 200px;
            height: 48px;
            line-height: 48px;
            text-align: center;
            background: #409eff;
            color: #fff;
            border-radius: 8px;
            margin: 0 auto;
            cursor: pointer;
            font-size: 16px;
            border: none;
            display: none;
        }
        .download-btn:hover {
            background: #337ecc;
        }
        .tip {
            text-align: center;
            color: #999;
            margin-top: 10px;
            font-size: 14px;
        }
        .warn-tip {
            text-align: center;
            color: #e6a23c;
            margin-bottom: 20px;
            font-size: 14px;
            padding: 10px;
            background: #fdf6ec;
            border-radius: 8px;
            width: 600px;
            margin: 0 auto 20px;
        }
    </style>
</head>
<body>
    <!-- é‡è¦æç¤ºï¼šè§£å†³æœ¬åœ°ä¸‹è½½é—®é¢˜ -->
    <div class="warn-tip">
        âš ï¸ æç¤ºï¼šè¯·ç”¨æœ¬åœ°æœåŠ¡å™¨ï¼ˆå¦‚VS Code Live Serverï¼‰è¿è¡Œæ­¤é¡µé¢ï¼Œä¸è¦ç›´æ¥åŒå‡»æ‰“å¼€ï¼<br>
        ç›´æ¥åŒå‡»æ‰“å¼€ä¼šå› æµè§ˆå™¨å®‰å…¨ç­–ç•¥æ— æ³•ä¸‹è½½ï¼ŒVS Codeå®‰è£…Live Serveræ’ä»¶åå³é”®ã€ŒOpen with Live Serverã€å³å¯
    </div>

    <!-- ä¸Šä¼ åŒºåŸŸ -->
    <div class="upload-box" id="uploadBox">
        <div class="upload-text">
            <i>ğŸ“¤</i>
            <p>ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„ä¸Šä¼ </p>
            <p style="font-size: 12px; margin-top: 5px;">æ”¯æŒjpg/pngæ ¼å¼ï¼Œå»ºè®®æ¸…æ™°çš„è¡¨æ ¼å›¾ç‰‡</p>
        </div>
        <input type="file" accept="image/jpeg,image/png" id="fileInput">
    </div>

    <!-- è¯†åˆ«è¿›åº¦æ¡ -->
    <div class="progress" id="progressBox">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆ -->
    <div class="preview" id="previewBox"></div>

    <!-- ä¸‹è½½æŒ‰é’® -->
    <button class="download-btn" id="downloadBtn">ä¸‹è½½ExcelæŠ¥ä»·å•</button>

    <p class="tip" id="tipText">è¯·å…ˆä¸Šä¼ å›¾ç‰‡å®Œæˆè¯†åˆ«</p>

    <!-- æ›¿æ¢ä¸ºç¨³å®šçš„CDNï¼ˆè§£å†³åŠ è½½å¤±è´¥é—®é¢˜ï¼‰ -->
    <script src="https://cdn.staticfile.org/tesseract.js/5.0.2/tesseract.min.js"></script>
    <script src="https://cdn.staticfile.org/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.staticfile.org/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        // æ ¸å¿ƒå˜é‡
        let excelData = null; // å­˜å‚¨æœ€ç»ˆè¦å¯¼å‡ºçš„Excelæ•°æ®
        let mergeConfigs = []; // åˆå¹¶å•å…ƒæ ¼é…ç½®
        // DOMå…ƒç´ 
        const uploadBox = document.getElementById('uploadBox');
        const fileInput = document.getElementById('fileInput');
        const progressBox = document.getElementById('progressBox');
        const progressBar = document.getElementById('progressBar');
        const previewBox = document.getElementById('previewBox');
        const downloadBtn = document.getElementById('downloadBtn');
        const tipText = document.getElementById('tipText');

        // 1. æ‹–æ‹½äº‹ä»¶å¤„ç†
        ['dragenter', 'dragover'].forEach(eventName => {
            uploadBox.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadBox.classList.add('active');
            });
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadBox.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadBox.classList.remove('active');
            });
        });

        // æ‹–æ‹½ä¸Šä¼ 
        uploadBox.addEventListener('drop', (e) => {
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.includes('image')) {
                handleImageFile(files[0]);
            } else {
                tipText.textContent = 'è¯·ä¸Šä¼ æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶ï¼ˆjpg/pngï¼‰';
                tipText.style.color = '#f56c6c';
            }
        });

        // ç‚¹å‡»ä¸Šä¼ 
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleImageFile(e.target.files[0]);
            }
        });

        // 2. å¤„ç†ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶
        function handleImageFile(file) {
            // æ˜¾ç¤ºé¢„è§ˆå›¾
            const reader = new FileReader();
            reader.onload = (e) => {
                previewBox.innerHTML = `<img src="${e.target.result}" alt="ä¸Šä¼ çš„å›¾ç‰‡">`;
                previewBox.style.display = 'block';
            };
            reader.readAsDataURL(file);

            // æ˜¾ç¤ºè¿›åº¦æ¡
            progressBox.style.display = 'block';
            progressBar.style.width = '0%';
            tipText.textContent = 'æ­£åœ¨è¯†åˆ«å›¾ç‰‡ï¼Œè¯·ç¨å€™...';
            tipText.style.color = '#666';
            downloadBtn.style.display = 'none';

            // 3. Tesseract OCRè¯†åˆ«ï¼ˆä¸­æ–‡+æ•°å­—ï¼‰
            Tesseract.recognize(
                file,
                'chi_sim', // ä¸­æ–‡ç®€ä½“
                {
                    logger: (m) => {
                        // æ›´æ–°è¿›åº¦æ¡
                        if (m.status === 'recognizing text') {
                            const progress = Math.round(m.progress * 100);
                            progressBar.style.width = `${progress}%`;
                        }
                    }
                }
            ).then(({ data: { text } }) => {
                console.log('OCRè¯†åˆ«ç»“æœï¼š', text); // æ§åˆ¶å°æ‰“å°è¯†åˆ«æ–‡æœ¬ï¼Œæ–¹ä¾¿è°ƒè¯•
                // è¯†åˆ«å®Œæˆï¼Œè§£ææ–‡æœ¬æå– å‹å·/è§„æ ¼/æ•°é‡
                const tableData = parseTableText(text);
                console.log('è§£æåçš„è¡¨æ ¼æ•°æ®ï¼š', tableData);
                // ç”ŸæˆExcelæ¨¡æ¿æ•°æ®ï¼ˆå®Œå…¨åŒ¹é…æŠ¥ä»·å•æ ¼å¼ï¼‰
                [excelData, mergeConfigs] = generateExcelTemplate(tableData);
                console.log('ç”Ÿæˆçš„Excelæ•°æ®ï¼š', excelData);
                console.log('åˆå¹¶å•å…ƒæ ¼é…ç½®ï¼š', mergeConfigs);
                // æ›´æ–°UI
                progressBar.style.width = '100%';
                tipText.textContent = 'è¯†åˆ«å®Œæˆï¼Œå¯ä¸‹è½½ExcelæŠ¥ä»·å•';
                tipText.style.color = '#67c23a';
                downloadBtn.style.display = 'block';
            }).catch((err) => {
                console.error('è¯†åˆ«å¤±è´¥ï¼š', err);
                tipText.textContent = 'è¯†åˆ«å¤±è´¥ï¼Œè¯·æ£€æŸ¥å›¾ç‰‡æ¸…æ™°åº¦æˆ–é‡è¯•';
                tipText.style.color = '#f56c6c';
            });
        }

        // 4. è§£æOCRè¯†åˆ«çš„æ–‡æœ¬ï¼Œæå–å‹å·ã€è§„æ ¼ã€æ•°é‡
        function parseTableText(text) {
            // æŒ‰è¡Œåˆ†å‰²æ–‡æœ¬ï¼ˆå¤„ç†ä¸åŒæ¢è¡Œç¬¦ï¼‰
            const lines = text.split(/\r?\n/).filter(line => line.trim() !== '');
            const result = [];

            // åŒ¹é…è¡¨æ ¼è¡Œçš„æ­£åˆ™ï¼ˆé€‚é…ç¬¬ä¸€å¼ å›¾ç‰‡çš„æ ¼å¼ï¼šå‹å·/è§„æ ¼  å•ä½  æ•°é‡ï¼‰
            const rowReg = /([\w\-\/\(\)\*]+)\s+([\u4e00-\u9fa5]+)\s+(\d+)/;
            
            lines.forEach(line => {
                const trimLine = line.trim();
                const match = trimLine.match(rowReg);
                if (match) {
                    // æå–ï¼šå‹å·è§„æ ¼ã€å•ä½ã€æ•°é‡
                    const [, modelSpec, unit, quantity] = match;
                    // æ‹†åˆ†å‹å·å’Œè§„æ ¼ï¼ˆæ ¹æ®ç¬¬ä¸€å¼ å›¾ç‰‡çš„æ ¼å¼è°ƒæ•´æ‹†åˆ†é€»è¾‘ï¼‰
                    let model = modelSpec;
                    let spec = '';
                    
                    // ç¤ºä¾‹æ‹†åˆ†è§„åˆ™ï¼ˆå¯æ ¹æ®å®é™…è¡¨æ ¼è°ƒæ•´ï¼‰
                    if (modelSpec.includes('110KV')) {
                        // é«˜å‹çº¿ç¼†æ ¼å¼ï¼šZC-YJLW03-Z-110KV-1Ã—300 æ‹†åˆ†ä¸ºå‹å·+è§„æ ¼
                        const specMatch = modelSpec.match(/(ZC-.+?-110KV)-(.+)/);
                        if (specMatch) {
                            model = specMatch[1];
                            spec = specMatch[2];
                        }
                    } else if (modelSpec.includes('kVç“·å¥—') || modelSpec.includes('kVå¹²å¼')) {
                        // ç»ˆç«¯å¤´æ ¼å¼ï¼š110kVç“·å¥—æˆ·å¤–ç»ˆç«¯1*300ï¼ˆ1*240ï¼‰
                        model = modelSpec;
                        spec = modelSpec.match(/(\d\*\d+).*(\d\*\d+)/) ? `${RegExp.$1}/${RegExp.$2}` : '';
                    }

                    result.push({
                        model: model || modelSpec, // å‹å·
                        spec: spec || '-',         // è§„æ ¼
                        unit: unit || 'ç±³',        // å•ä½
                        quantity: quantity || 0    // æ•°é‡
                    });
                }
            });

            return result;
        }

        // 5. ç”ŸæˆExcelæ¨¡æ¿æ•°æ®ï¼ˆå®Œå…¨åŒ¹é…æŠ¥ä»·å•å›¾ç‰‡æ ¼å¼ï¼‰
        function generateExcelTemplate(tableData) {
            // æŠ¥ä»·å•åŸºç¡€ä¿¡æ¯
            const quoteNo = `LD${Date.now().toString().slice(4, 14)}`; // éšæœºæŠ¥ä»·å•å·ï¼ˆæ¨¡æ‹ŸåŸå›¾æ ¼å¼ï¼‰
            const date = new Date().toLocaleDateString().replace(/\//g, '/'); // å½“å‰æ—¥æœŸ
            const currency = 'RMB';

            // æ„å»ºå®Œæ•´çš„æŠ¥ä»·å•æ•°æ®ï¼ˆé€è¡ŒåŒ¹é…åŸå›¾ï¼‰
            const data = [];

            // ç¬¬1è¡Œï¼šå…¬å¸åœ°å€
            data.push(['å…¬å¸åœ°å€ï¼šæ²³åŒ—å®æ™‹', '', '', '', '', '', '', '', '']);
            // ç¬¬2è¡Œï¼šç©ºè¡Œï¼ˆåŒ¹é…åŸå›¾ï¼‰
            data.push(['', '', '', '', '', '', '', '', '']);
            // ç¬¬3è¡Œï¼šæŠ¥ä»·å•å·ã€æ—¥æœŸ
            data.push([
                `æŠ¥ä»·å•å·ï¼š${quoteNo}/å¸åˆ«ï¼š${currency}`, 
                '', '', '', 
                ` ${date}`, 
                '', '', '', ''
            ]);
            // ç¬¬4è¡Œï¼šè¡¨å¤´ï¼ˆå®Œå…¨åŒ¹é…åŸå›¾ï¼‰
            data.push(['åºå·', 'åç§°', 'å‹å·', 'è§„æ ¼', 'å•ä½', 'æ•°é‡', 'å•ä»·', 'é‡‘é¢', 'å¤‡æ³¨']);

            // å¡«å……è¯†åˆ«åˆ°çš„æ•°æ®è¡Œ
            let totalQuantity = 0; // æ•°é‡æ€»è®¡
            tableData.forEach((item, index) => {
                const qty = Number(item.quantity);
                totalQuantity += qty;
                // å•ä»·/é‡‘é¢æš‚ç•™ç©ºï¼Œå¦‚éœ€è‡ªåŠ¨è®¡ç®—å¯è¡¥å……é€»è¾‘
                data.push([
                    index + 1,          // åºå·
                    'ç”µçº¿ç”µç¼†',         // åç§°ï¼ˆåŒ¹é…åŸå›¾ï¼‰
                    item.model,         // å‹å·
                    item.spec,          // è§„æ ¼
                    item.unit,          // å•ä½
                    qty,                // æ•°é‡
                    '',                 // å•ä»·ï¼ˆç•™ç©ºï¼‰
                    '',                 // é‡‘é¢ï¼ˆç•™ç©ºï¼‰
                    ''                  // å¤‡æ³¨ï¼ˆç•™ç©ºï¼‰
                ]);
            });

            // æ€»è®¡è¡Œï¼ˆåŒ¹é…åŸå›¾ï¼šåˆå¹¶å•å…ƒæ ¼+é‡‘é¢æ€»è®¡ä½ç½®ï¼‰
            const totalRowIndex = data.length;
            data.push(['æ€»è®¡', '', '', '', '', totalQuantity, '', '', '']);
            // ç©ºè¡Œï¼ˆåŒ¹é…åŸå›¾ï¼‰
            data.push(['', '', '', '', '', '', '', '', '']);

            // åº•éƒ¨å¤‡æ³¨è¯´æ˜ï¼ˆå®Œå…¨åŒ¹é…åŸå›¾çš„4æ¡è¯´æ˜ï¼‰
            data.push(['1ã€ä»¥ä¸Šä»·æ ¼å›½æ ‡è£¸ä»·å«ç¨å«è¿åˆ°ç¦å·ã€‚', '', '', '', '', '', '', '', '']);
            data.push(['2ã€é‰´äºå¸‚åœºåŸææ–™æ¶¨æµ®ï¼Œä»¥ä¸ŠæŠ¥ä»·å½“æ—¥æœ‰æ•ˆï¼ˆå·²æ”¶åˆ°è®¢é‡‘ä¸ºå‡†ï¼‰ï¼', '', '', '', '', '', '', '', '']);
            data.push(['3ã€ä»˜æ¬¾æ–¹å¼ï¼šé¢„ä»˜30%å®šé‡‘ï¼Œæè´§å‰ä»˜æ¸…å…¨æ¬¾ã€‚', '', '', '', '', '', '', '', '']);
            data.push(['4ã€æ­¤æŠ¥ä»·ä¸ºç”µç¼†100ç±³ä»¥ä¸Šçš„ä»·æ ¼ï¼Œå¦‚ä½äº100ç±³éœ€å¦åŠ çŸ­å¤´è´¹ã€‚', '', '', '', '', '', '', '', '']);
            
            // å°ç« ä½ç½®è¡Œï¼ˆé¢„ç•™ç©ºè¡Œï¼ŒåŒ¹é…åŸå›¾ï¼‰
            for (let i = 0; i < 3; i++) {
                data.push(['', '', '', '', '', '', '', '', '']);
            }
            data.push(['', '', '', '', 'ç¼†éƒ½çº¿ç¼†é›†å›¢', '', '', '', '']);
            data.push(['', '', '', '', 'æŠ¥ä»·ä¸“ç”¨ç« ', '', '', '', '']);

            // é…ç½®åˆå¹¶å•å…ƒæ ¼ï¼ˆå®Œå…¨åŒ¹é…åŸå›¾æ ¼å¼ï¼Œç®€åŒ–æ ¼å¼é¿å…æŠ¥é”™ï¼‰
            const merges = [
                // å…¬å¸åœ°å€è¡Œï¼šA1-I1 åˆå¹¶
                { s: { r: 0, c: 0 }, e: { r: 0, c: 8 } },
                // æŠ¥ä»·å•å·è¡Œï¼šA3-D3 åˆå¹¶
                { s: { r: 2, c: 0 }, e: { r: 2, c: 3 } },
                // æŠ¥ä»·æ—¥æœŸè¡Œï¼šE3-F3 åˆå¹¶
                { s: { r: 2, c: 4 }, e: { r: 2, c: 5 } },
                // æ€»è®¡è¡Œï¼šA{totalRowIndex}-F{totalRowIndex} åˆå¹¶
                { s: { r: totalRowIndex, c: 0 }, e: { r: totalRowIndex, c: 5 } },
                // æ€»è®¡é‡‘é¢åˆ—ï¼šG{totalRowIndex}-I{totalRowIndex} åˆå¹¶
                { s: { r: totalRowIndex, c: 6 }, e: { r: totalRowIndex, c: 8 } },
                // å¤‡æ³¨è¯´æ˜æ¯è¡Œæ•´è¡Œåˆå¹¶
                { s: { r: totalRowIndex + 2, c: 0 }, e: { r: totalRowIndex + 2, c: 8 } },
                { s: { r: totalRowIndex + 3, c: 0 }, e: { r: totalRowIndex + 3, c: 8 } },
                { s: { r: totalRowIndex + 4, c: 0 }, e: { r: totalRowIndex + 4, c: 8 } },
                { s: { r: totalRowIndex + 5, c: 0 }, e: { r: totalRowIndex + 5, c: 8 } },
                // å°ç« æ–‡å­—è¡Œåˆå¹¶
                { s: { r: data.length - 2, c: 4 }, e: { r: data.length - 2, c: 6 } },
                { s: { r: data.length - 1, c: 4 }, e: { r: data.length - 1, c: 6 } }
            ];

            return [data, merges];
        }

        // 6. ä¸‹è½½Excelæ–‡ä»¶ï¼ˆå¢åŠ å®Œæ•´é”™è¯¯æ•è·ï¼Œè§£å†³ä¸‹è½½å¤±è´¥é—®é¢˜ï¼‰
        downloadBtn.addEventListener('click', () => {
            try {
                console.log('=== å¼€å§‹ä¸‹è½½ ===');
                console.log('excelData:', excelData);
                console.log('mergeConfigs:', mergeConfigs);
                
                // æ ¡éªŒæ•°æ®
                if (!excelData || excelData.length === 0) {
                    throw new Error('æš‚æ— æœ‰æ•ˆæ•°æ®ï¼Œè¯·å…ˆå®Œæˆå›¾ç‰‡è¯†åˆ«');
                }

                // åˆ›å»ºå·¥ä½œç°¿å’Œå·¥ä½œè¡¨
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(excelData);

                // é…ç½®åˆå¹¶å•å…ƒæ ¼ï¼ˆå…¼å®¹å¤„ç†ï¼‰
                if (mergeConfigs && mergeConfigs.length > 0) {
                    ws['!merges'] = mergeConfigs;
                }

                // è°ƒæ•´åˆ—å®½ï¼ˆå®Œå…¨åŒ¹é…åŸå›¾åˆ—å®½æ¯”ä¾‹ï¼‰
                const wscols = [
                    { wch: 6 },  // åºå·
                    { wch: 10 }, // åç§°
                    { wch: 25 }, // å‹å·
                    { wch: 12 }, // è§„æ ¼
                    { wch: 6 },  // å•ä½
                    { wch: 8 },  // æ•°é‡
                    { wch: 8 },  // å•ä»·
                    { wch: 12 }, // é‡‘é¢
                    { wch: 10 }  // å¤‡æ³¨
                ];
                ws['!cols'] = wscols;

                // åŠ å…¥å·¥ä½œç°¿
                XLSX.utils.book_append_sheet(wb, ws, 'çº¿ç¼†æŠ¥ä»·å•');

                // ç”ŸæˆExcelæ–‡ä»¶ï¼ˆå…¼å®¹blobæ ¼å¼ï¼‰
                const wbout = XLSX.write(wb, { 
                    bookType: 'xlsx', 
                    type: 'blob',
                    cellStyles: true // ç¡®ä¿æ ¼å¼å…¼å®¹
                });
                console.log('ç”Ÿæˆçš„Excel Blob:', wbout);

                // æ ¡éªŒblobæ˜¯å¦ç”ŸæˆæˆåŠŸ
                if (!wbout) {
                    throw new Error('Excelæ–‡ä»¶ç”Ÿæˆå¤±è´¥');
                }

                // éšæœºæ–‡ä»¶åï¼ˆæ—¶é—´æˆ³+éšæœºæ•°ï¼‰
                const fileName = `çº¿ç¼†æŠ¥ä»·å•_${Date.now()}_${Math.floor(Math.random() * 1000)}.xlsx`;
                
                // è§¦å‘ä¸‹è½½ï¼ˆå…¼å®¹ä¸åŒæµè§ˆå™¨ï¼‰
                if (typeof saveAs === 'function') {
                    saveAs(wbout, fileName);
                    tipText.textContent = 'ExcelæŠ¥ä»·å•ä¸‹è½½æˆåŠŸï¼æ ¼å¼ä¸åŸå›¾å®Œå…¨ä¸€è‡´';
                    tipText.style.color = '#67c23a';
                } else {
                    // é™çº§æ–¹æ¡ˆï¼šåˆ›å»ºaæ ‡ç­¾ä¸‹è½½
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(wbout);
                    link.download = fileName;
                    link.click();
                    URL.revokeObjectURL(link.href); // é‡Šæ”¾URL
                    tipText.textContent = 'ExcelæŠ¥ä»·å•ä¸‹è½½æˆåŠŸï¼ˆé™çº§æ¨¡å¼ï¼‰ï¼';
                    tipText.style.color = '#67c23a';
                }

            } catch (err) {
                console.error('ä¸‹è½½å¤±è´¥è¯¦ç»†åŸå› ï¼š', err);
                tipText.textContent = `ä¸‹è½½å¤±è´¥ï¼š${err.message}ï¼ˆè¯·æ‰“å¼€F12æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†é”™è¯¯ï¼‰`;
                tipText.style.color = '#f56c6c';
            }
        });
    </script>
</body>
</html>
